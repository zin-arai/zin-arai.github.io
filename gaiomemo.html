<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=iso-2022-jp">
<TITLE>GAIOメモ(作成途中)</TITLE>
<STYLE TYPE="text/css" MEDIA=screen>
<!--
  BODY  { background: #FFEECC; color: black; }
  P EM  { font-weight: bold; }
  P STRONG  { font-weight: bold; color: red; }
  P{
    line-height:120%;
    text-indent:0pt;
    text-align:left;
    margin:0px 10px 14px 40px;
  }
  OL{
    line-height:120%;
    margin:0px 10px 14px 20px;
  }
  H1{
    margin: 24px 0px 4px 0px;
    padding: 4px;
    border-width: 0px 0px 0px 12px;
    border-style: none none none solid;
    color: #000000;
    font-weight: bold;}
  LI { margin: 0px 60px 12px 12px; line-height:120%; }
-->
</STYLE>
</HEAD>
<H1>この文章について</H1>
<P>
この文章は、力学系研究のためのプログラムパッケージ
<A href="http://math-www.uni-paderborn.de/~agdellnitz/gaio/">GAIO</A>
を使う上で私の気づいた事をつれづれなるままに書き連ねたものです。
あくまで個人的メモですので、内容については完全に無保証です。悪しからず。
</P>
<P>
<OL>
 <LI> <A href="#whatis">GAIOとは？</A>
 <LI> <A href="#algorithm">subdivision algorithmとは？</A>
 <LI> <A href="#files">GAIOを構成するファイルたち</A>
 <LI> <A href="#compile">コンパイル＆インストール</A>
 <LI> <A href="#run">計算してみる</A>
 <LI> <A href="#model">モデルを作ってみる</A>
 <LI> <A href="#functions">関数とその引数</A>
 <LI> <A href="#reference">参考文献</A>
</OL>
</P>
<H1 id="whatis">GAIOとは？</H1>
<P>
GAIO とは Global Analyis of Invarian Objects の頭文字であり、
<A href="http://math-www.uni-paderborn.de/~agdellnitz">Michael Dellnitz</A>、
<A href="http://www-math.uni-paderborn.de/~junge/">Oliver Junge</A>
を中心とする力学系研究者のグループにより開発された、力学系研究のためのプログラム群の総称です。
</P>

<P>
GAIO は subdivision argorithm と彼らが呼ぶ方法によって、アトラクターや不変多様体の covering を見つけだしてくれます。
また計算結果を Matlab のグラフィックス機能を用いて図示することができるので、lorenz アトラクターをマウスでぐりぐり回転させたり、アニメーションをさせるといったことが簡単に出来ます。
</P>

<P>
現在のバージョンの GAIO は
<A href="http://www.cybernet.co.jp/matlab/">Matlab</A>
への追加パッケージ (Toolbox) という形で実装されており、GAIO を使うためには Matlab が必要になります。
GAIO の開発は Linux 上で行なわれているようですが、Matlab が動作するたいがいの Unix クローン上で使えると思います。
また、一部の機能を用いるためには有料のライブラリ
<A href="http://www.netscience.ne.jp/comid/engin/leda/index.html">LEDA</A>
が必要になりますが、不変測度関係の計算をしない限りは LEDA 抜きでも十分使えます。
</P>

<P>
GAIO を入手するためには開発者にメールで連絡してソースファイルをもらう必要があります。
<A href="http://math-www.uni-paderborn.de/~agdellnitz/gaio/">ウェブページ</A>
からたどってみてください。
</P>

<H1 id="algorithm">subdivision algorithmとは？</H1>
<P>
論文を読め。
</P>

<H1 id="files">GAIOを構成するファイルたち</H1>
<P>
ディレクトリ "GAIODIR" 以下に GAIO のソースアーカイブを展開してあるとします。
GAIO の実体は GAIODIR 以下の各ディレクトリにある *.m や *.c という名前のファイルたちです。
</P>
<P>
.m という拡張子はそのファイルが Matlab のスクリプトファイルであることを表し、
拡張子を除いたファイル名を Matlab に打ち込むとこのファイルが呼ばれます。
要するに Matlab のコマンドが単に並んでいるテキストファイルですが、先頭に簡単な解説がついているので一読をおすすめします。
</P>

<P>
.c という拡張子を持つファイルは C言語のソースファイルです。
主にスクリプトでは速度的に問題がある関数が C言語で書かれています。
これらのファイルを Matlab から呼び出せるようにするには、次節で解説するように、コンパイルして shared object に変換しなくてはなりません。
</P>


<H1 id="compile">コンパイル＆インストール</H1>
<P>
README を読んでがんばれ。
gcc にコンパイルオプション "-lc" を渡さないと shared object の作成でコケるかもしれない。
</P>

<H1 id="run">計算してみる</H1>
<P>
とりあえず GAIODIR/doc/matlab/dansebook.ps の11ページにある lorenz アトラクターの例を実行してみましょう。環境変数 GAIODIR が正しくセットされていることを確認して matlab を起動します。
ユーザのホーム以下に GAIO を置いている場合は
addpath /home/ユーザ名/gaio/gaio と入力して GAIODIR を matlab の検索パスに加えてください。
ここで次のコマンドたちを順次実行します。
先頭の数字は以下の説明のためにつけた行番号です。
</P>
<CENTER>
<TABLE >
<TR><TD>01: <TD>lorenz = Model('lorenz')</TR>
<TR><TD>02: <TD>rk4 = Integrator('RungeKutta4')</TR>
<TR><TD>03: <TD>rk4.model = lorenz </TR>
<TR><TD>04: <TD>rk4.tFinal = -0.1</TR>
<TR><TD>05: <TD>rk4.h = -0.01</TR>
<TR><TD>06: <TD>tree = Tree([0,0,0], [120,120,160])</TR>
<TR><TD>07: <TD>tree.integrator = rk4 </TR>
<TR><TD>08: <TD>tree.domain_points = Points('Edges', 3, 100)</TR>
<TR><TD>09: <TD>tree.image_points = Points('Center',3)</TR>
<TR><TD>10: <TD>x = [0;0;0]</TR>
<TR><TD>11: <TD>depth = 21</TR>
<TR><TD>12: <TD>tree.insert(x,depth)</TR>
<TR><TD>13: <TD>steps = 10</TR>
<TR><TD>14: <TD>gum(tree,depth,steps)</TR>
</TABLE>
</CENTER>
<P>
エラーがなければ step 1: 40 boxes ... step 10: 19351 boxes とかなんとか出力されるでしょう。これで原点の安定多様体を含む19531個のボックスが得られました。
plotb(tree) と入力すれば matlab の plot 機能を呼び出してこれらのボックスを図示することができます。
</P>

<P>
上の例において各行が何をしているのか簡単に見てみます。
実際に計算を実行しているのは14行目だけで、それまでは全て状況の設定です。
各コマンドについてより詳しくは後の節を参照してください。
</P>

<P>
まず1行目では、変数 lorenz によって lorenz 方程式のモデルが呼び出せるように設定します。
右辺で GAIODIR/gaio/@Model/Model.m が呼び出され、引数が 'lorenz' なので Model.m は GAIODIR/models/アーキテクチャ名/lorenz.so というファイルを変数 lorenz に渡します。
ここで左辺の変数 lorenz と右辺のモデル名 lorenz を混同しないようにしてください。
左辺は変数なので本当は何でも良いのです。
例えば1行目を hogehoge = Model('lorenz') にした場合は、3行目も rk4.model = hogehoge にすれば同じ結果が得られます。
</P>

<P>
2行目から5行目では常微分方程式の数値積分をどのように行なうかを設定します。
2行目では変数 rk4 によって4次のルンゲ・クッタ法が呼び出されるように設定します。
GAIODIR/integrators に他の積分メソッドもありますし、自分で追加することもできます。
3行目では rk4 に先に定義した lorenz を積分するように指示します。
4行目は積分を止める時間、5行目は差分するときの1ステップの長さの定義です。
これらが負の数値になっているのは、ここで求めようとしているのが安定多様体だからであり、不安定多様体を見たい場合は正負を反転させます。
</P>

<P>
6行目から9行目において、"tree" の設定を行ないます。
まずは6行目において一番大元になる box を、中心が原点で各座標軸方向の大きさがそれぞれ 120、120、160 となるような箱として定めます。
7行目では tree を力学系によって分割していくときに、rk4 を呼び出すように設定します。
rk4 は先に設定した数値積分法であり、rk4.model = lorenz なので、変数 tree に対して、それに作用する力学系として lorenz が関連づけられたことになります。
8行目と9行目は、力学系によって変形された box がもとの box たちとどのように交わるかを判定するための方法を決定しています。
</P>

<P>
10行目と11行目は単に12行目で用いる数値を変数に代入しているだけです。
数値を代入すると 12行目は tree.insert([0;0;0],21) となりますが、これは6行目で設定した box を21回分割して、その中から原点を含む box を tree に追加しろという命令です。
box の分割は各座標方向に順に行なわれ、今の場合だと相空間は3次元なのでそれぞれの座標方向に7回分割が行なわれます。
すなわち、原点を中心とする大きな box が各座標方向に 2^7 = 128 分割されて出来た 2097152 個の小さな box たちの中から、原点を含む box のみに注目して、tree に取り込んだわけです。
便宜上この box を b_0 と名付けましょう。
</P>

<P>
14行目で計算が行なわれます。
現在 tree の 21回目の分割において選ばれているのは b_0 のみなので、b_0 を rk4 で送ります。
すなわち、ルンゲ・クッタ法で -0.1秒の数値積分を行ないます。
この積分により b_0 は変形され、もとの b_0 からはみ出して周囲の box たちと交わりを持ちます。
どの box と交わるかを8行目と9行目の設定に基づいて判定し、交わると判定された box を tree に追加します。
これで1ステップが終わりです。
次のステップでは、一回目のステップで選ばれた box たちに対して同じように数値積分を行ない、交わる box の判定をします。
これを steps = 10回くり返して最終的に出来上がった tree の box の数が 19351 ということになります。
</P>

<H1 id="model">モデルを作る</H1>
<P>
作りたいモデルに似ているモデルを GAIODIR/models から見つけて、少しずつ変形していくとよいでしょう。
多少 C言語の知識が必要になります。
モデル名.c という名前でファイルを保存して、GAIODIR/models で make を実行すると、GIODIR/models/アーキテクチャ名/ というディレクトリに モデル名.so というファイルができます。
これで作ったモデルを dansebook.ps にある既製のモデルと同様に Model('モデル名') で呼び出せます。
</P>

<H1 id="functions">関数とその引数</H1>


<H1 id="compile">参考文献</H1>
<P>
<OL>
<LI id="dansebook"> M. Dellnitz, G. Froyland and O. Junge, The Algorithms Behind GAIO - Set Oriented Numerical Methods for Dyanmical Systems, GAIODIR/doc/matlab/dansebook.ps
<LI id="dansebook"> M. Dellnitz and A. Hohmann, A subdivision algorithm for the computation of unstable manifolds and global attractors, Numr. Math. 75 (1997), 293-317.
</OL>
</P>

<HR>
<ADDRESS>
2002-07-29
<A href="mailto:arai@kusm.kyoto-u.ac.jp">荒井 迅 </A>
</ADDRESS>
</HTML>
